# ✅ Step 1: Node 환경
FROM node:22-alpine AS build
WORKDIR /app

# 패키지 설치
COPY package*.json ./
RUN npm install

# Vite 프로젝트 복사 및 빌드
COPY ./test .
RUN npm run build

# ✅ Step 2: 정적 파일을 서빙하기 위한 Nginx
FROM nginx:alpine
COPY --from=build /app/dist /usr/share/nginx/html

# 포트 설정
EXPOSE 80

# Koyeb 헬스체크를 위해 포트 80 사용
CMD ["nginx", "-g", "daemon off;"]